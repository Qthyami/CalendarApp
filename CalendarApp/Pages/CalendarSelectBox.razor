@using System.Globalization
@using CalendarApp.Pages

<calendar-select-box class="calendar-select">
            <button class="today-dropdown" type="button" @onclick="TogglePopup">
                <span class="today-text">@Date.ToString("dd MMM yyyy", CultureInfo.InvariantCulture)</span>
                <svg class="icon icon-caret dropdown-arrow" width="7" height="5">
                    <use href="/images/icons-sprite.svg#icon-caret"></use>
                </svg>
            </button>

    @if (IsPopupOpened) {
        <CalendarView 
            Date="@Date"
            DateChanged="@DateChangedHandler" />
    }
</calendar-select-box>

@code {
    [Parameter] public DateTime Date { get; set; }
    [Parameter] public EventCallback<DateTime> DateChanged { get; set; }

    private bool IsPopupOpened { get; set; }
    private void TogglePopup() => IsPopupOpened = !IsPopupOpened;

    private async Task DateChangedHandler(DateTime newDate) {
        Date = newDate;
        IsPopupOpened = false;
       await DateChanged.InvokeAsync(newDate);
    }
}

